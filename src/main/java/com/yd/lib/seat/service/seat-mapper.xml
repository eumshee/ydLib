<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yd.lib.seat.service.seat-mapper">
	<!-- 좌석정보 확인 -->
	<select id="seatList" resultType="com.yd.lib.seat.vo.SeatroomVO">
		select s.*, r.* from seat s
		left join SEATROOM r on s.seat_num = r.seat_num
		order by s.seat_num
	</select>
	
	<select id="userSeatSelect" parameterType="com.yd.lib.users.vo.UsersVO" resultType="com.yd.lib.seat.vo.SeatroomVO">
		select * from seat s
		left join SEATROOM r on s.seat_num = r.seat_num
		where r.user_id = #{user_Id}
	</select>
	
	<insert id="seatOneInsert" parameterType="com.yd.lib.seat.vo.SeatroomVO">
		insert into SEATROOM(SEAT_PICK_NUM,USER_ID,SEAT_NUM,SEAT_START_TIME,SEAT_END_TIME,SEAT_END_EARLY)
		values(seat_pick_seq.nextval,
		#{user_Id},
		#{seat_Num},
		SYSDATE,
		SYSDATE + (interval '3' hour),		
		null) 
	</insert>
	
	<update id="seatEnd" parameterType="com.yd.lib.seat.vo.SeatroomVO">
		update SEATROOM
		set seat_end_early = SYSDATE
		where seat_num = #{seat_Num}
	</update>
	
	<select id="seatSearch" parameterType="com.yd.lib.seat.vo.SeatroomVO" resultType="com.yd.lib.seat.vo.SeatroomVO">
		select * from SEATROOM
		where user_id = #{user_Id}
	</select>
</mapper>